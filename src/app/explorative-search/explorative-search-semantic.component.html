<ngb-alert type="info" *ngIf="infoAlert" (close)="infoAlert = false">
    <div class="row">
        <div class="col-md-2">
            <i class="fa fa-6x fa-info-circle"></i>
        </div>
        <div class="col-md-10">
            <p>
                <strong>Let Us Help You</strong>
            </p>
            <ul>
                <li>You can click on any of the <strong>Properties/Reference</strong> below and obtain filter values</li>
                <li>If you click on one of the <strong>References</strong> your Explorer
                    will update with new properties for the selected reference.</li>
                <li>You can use the <strong>Path</strong> below to go back to a previous Reference by simply clicking on it.</li>
            </ul>
        </div>
    </div>
</ngb-alert>
<ol class="breadcrumb">
    <li class="breadcrumb-item active"
        *ngFor="let concept of conceptPaths; let i=index;">
        <button (click)="check(concept, i)"
                class="btn btn-link btn-sm"
                placement="bottom"
                ngbTooltip="Click to go back to {{concept.concept}}"
        >{{concept.concept}}</button>
    </li>
</ol>

<ng-template #valuesTemplateRef let-values>
    <div class="card">
        <div class="card-header">Available Values</div>
        <div class="card-body">
            <p>Select One or More Values</p>
            <div *ngFor="let eachVal of values">
                <label>
                    <input type="checkbox"
                           [disabled]="!disableManualFilters"
                           (change)="filtersSelected(eachVal, $event)"/>
                    <span><strong>{{eachVal}}</strong></span>
                </label>
            </div>
            <hr>
            <div *ngIf="valuesAreNumeric">
                <div class="row">
                    <p>Manual Filter
                    <span><button
                            class="btn btn-outline-secondary btn-sm"
                            (click)="disableManualFilters = !disableManualFilters"
                    >{{disableManualFilters ? 'Activate' : 'Deactivate'}}</button></span>
                    </p>
                </div>
                <div class="input-group-sm">
                    <label for="min"><span>min</span></label>
                    <input id="min" type="number"
                           class="form-control-sm"
                           [disabled]="disableManualFilters"
                           #minVal
                    >
                    <br>
                    <label for="max"><span>max</span></label>
                    <input id="max" type="number"
                           class="form-control-sm"
                           [disabled]="disableManualFilters"
                           #maxVal
                    >

                    <button class="btn btn-primary btn-sm"
                            [disabled]="disableManualFilters"
                            (click)="applyManualFilter(minVal.value, maxVal.value)"
                    >Apply</button>
                    <button class="btn btn-danger btn-sm"
                            [disabled]="disableManualFilters"
                            (click)="removeManualFilter(minVal.value, maxVal.value)"
                    >Remove</button>
                </div>
            </div>
        </div>
        <div class="card-footer">
            <button class="btn btn-primary" (click)="noFilterSelected()"
                    [disabled]="disableAddPropBtn || !disableManualFilters"
            >Add Property without Filters</button>
        </div>
    </div>
</ng-template>
<div [hidden]="!hiddenElement">
    <div class="row">
        <!--<pre>-->
        <!--<code>-->
        <!--{{sparqlSelectedOption | json}}-->
        <!--</code>-->
        <!--</pre>-->
        <div class="table-responsive">
            <table class="table table-hover table-bordered">
                <caption>Product Overview</caption>
                <thead>
                <tr>
                    <th>
                        Properties
                    </th>
                    <th>
                        Specifications
                    </th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let column of sparqlSelectedOption?.columns; let i=index">
                    <th scope="row">
                        {{column}}
                    </th>
                    <td>
                        {{sparqlSelectedOption.rows[0][i]}}
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="row" style="margin-top: 15px">
        <div class="col-md-6">
            <button class="btn btn-outline-primary" (click)="hiddenElement=!hiddenElement">Back to Explorer</button>
        </div>
        <div class="col-md-6">
            <button class="btn btn-outline-warning" [disabled]="!negotiationEnable" (click)="negotiation()">
                Negotiate</button>
        </div>
    </div>
</div>


<div style="margin-top: 20px" *ngIf="configSPQ" [hidden]="hiddenElement">
        <h4> Property Explorer for {{configSPQ.frozenConcept}}</h4>
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        Available Properties
                    </div>
                    <ngb-alert type="info" [dismissible]="false" *ngIf="updateInfoAlert">
                        <p>Information Updated</p>
                    </ngb-alert>
                    <div class="card-body">
                        <div class="input-group-md">
                            <label for="typeahead-template"><span>Search</span></label>
                            <input id="typeahead-template"
                                   type="text"
                                   class="form-control"
                                   [(ngModel)]="searchModel"
                                   [ngbTypeahead]="search" [resultTemplate]="rt" [inputFormatter]="formatter"
                                   (keyup.enter)="checkUserSelection(searchModel)"
                            />
                            <ng-template #rt let-r="result" let-t="term">
                                {{ r.translatedProperty}}
                            </ng-template>

                        </div>
                        <br>
                        <br>
                        <select size="15" class="form-control mr-4">
                            <optgroup label="Properties">
                                <option *ngFor="let eachVal of dataResults"
                                        [selected]="searchModel.translatedProperty===eachVal.translatedProperty"
                                        (click)="getPropertyValues(eachVal)"
                                        [ngClass]="{'checkMark': propSelection(eachVal.translatedProperty)}"
                                >{{eachVal.translatedProperty}}
                                </option>
                            </optgroup>
                            <optgroup label="References">
                                <option *ngFor="let eachVal of objResults; let i=index;"
                                        [selected]="searchModel.translatedProperty===eachVal.translatedProperty"
                                        (click)="getReferenceValues(eachVal, i)">
                                    {{eachVal.translatedProperty}}
                                </option>
                            </optgroup>
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-4" *ngIf="emptyFilterAlert" >
                <ngb-alert type="danger" (close)="emptyFilterAlert=false">
                    <p> We couldn't find any filters for the selection.</p>
                </ngb-alert>
            </div>
            <div class="col-md-4" *ngIf="searchvalue.length > 0">
                <template [ngTemplateOutlet]="valuesTemplateRef" [ngTemplateOutletContext]="{$implicit: searchvalue}">
                </template>
            </div>
        </div>
    <hr>
</div>
<div *ngIf="sparqlJSON.parameters.length">
    <div class="row" [hidden]="hiddenElement">
        <button class="btn btn-lg btn-primary" (click)="genTable()">Obtain Results</button>
    </div>
    <br>
    <br>
    <div class="row" *ngIf="tableResult?.columns !== undefined">
        <div class="alert alert-info" role="info">
            <i class="fa fa-info-circle"></i> You can remove your selections by:
            <ul>
                <li>scrolling to the top of the table, click on the delete button.</li>
                <li>Click on the <kbd>Obtain Results</kbd> button again to update your results.</li>
            </ul>
        </div>
        <div class="table-responsive table-hover">
            <table class="table table-sm table-bordered">
                <caption>Available Results from NIMBLE</caption>
                <thead>
                <tr>
                    <th>
                        Results
                    </th>
                    <th *ngFor="let column of tableResult?.columns; let i=index" scope="col"
                        (mouseenter)="showSelectionDel=true" (mouseleave)="showSelectionDel=false">
                        {{column}}
                        <span *ngIf="showSelectionDel">
                            <i class="fa fa-minus-square" ngbTooltip="Remove {{column}}"  placement="right" (click)="removeSelection(column)"></i>
                        </span>
                    </th>
                    <th>
                        More
                    </th>
                </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let row of tableResult?.rows; let i=index">
                        <td>{{i+1}}</td>
                        <td *ngFor="let field of row">{{field}}</td>
                        <td *ngIf="tableResult?.uuids.length">
                            <button class="btn btn-xs btn-outline-success"
                                    (click)="getSparqlOptionalSelect(i)"
                            >
                            Further Info.
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>
    <!--<pre>-->
    <!--<code>{{tableResult | json}}</code>-->
    <!--</pre>-->
</div>

<!--<div class="container">-->
<!--<pre>-->
<!--<code>-->
<!--&lt;!&ndash;{{configSPQ | json}}&ndash;&gt;-->
<!--&lt;!&ndash;{{propertyResults | json}}&ndash;&gt;-->
<!--&lt;!&ndash;searchModel : {{searchModel | json}}&ndash;&gt;-->
<!--&lt;!&ndash;{{dataResults | json}}&ndash;&gt;-->
<!--&lt;!&ndash;{{objResults | json}}&ndash;&gt;-->
<!--{{sparqlJSON | json}}-->
<!--</code>-->
<!--</pre>-->
<!--</div>-->
