<div [hidden]="!loading">
	<img src="assets/form_loader.gif"/>
</div>

<form [hidden]="loading" [formGroup]="settingsForm" novalidate (ngSubmit)="save(settingsForm)">

	<h3 class="space-after">Company Data</h3>
	<button class="btn btn-primary space-after" type="button" (click)="changeData(changeModal)">
		<span>Request Company Data Change</span>
	</button>
	<div class="form-group row">
		<label class="col-2 col-form-label">Legal Name</label>
		<div class="col-10">
			<input type="text" class="form-control" [formControl]="settingsForm.controls['name']" readonly>
		</div>
	</div>
	<div class="form-group row">
		<label class="col-2 col-form-label">VAT Number</label>
		<div class="col-10">
			<input type="text" class="form-control" [formControl]="settingsForm.controls['vatNumber']" readonly>
		</div>
	</div>
	<div class="form-group row">
		<label class="col-2 col-form-label">
			<span>Verification Info</span>
			<span class="tooltip-icon" (click)="showVerificationTT(tooltip)"><i class="fa fa-question-circle"></i></span>
		</label>
		<div class="col-10">
			<input type="text" class="form-control" [formControl]="settingsForm.controls['verificationInformation']" readonly>
		</div>
	</div>
	<div class="form-group row">
		<label class="col-2 col-form-label">Website</label>
		<div class="col-10">
			<input type="text" class="form-control" [formControl]="settingsForm.controls['website']" readonly>
		</div>
	</div>
	<address-form [group]="settingsForm.controls.address"></address-form>

	<h3 class="space-after">Delivery Terms</h3>
	<div class="form-group row">
		<span class="col-2 col-form-label">
			<input type="checkbox" [(ngModel)]="aM" [ngModelOptions]="{standalone:true}" (change)="settingsForm.controls['name'].markAsDirty();changeFlag();">
		</span>
		<div class="col-10">
			<span class="form-control inline">Deliver to company address</span>
		</div>
	</div>
	<delivery-terms-form [group]="settingsForm.controls.deliveryTerms"></delivery-terms-form>

	<h3 class="space-after">Payment Terms</h3>
	<payment-means-form [group]="settingsForm.controls.paymentMeans"></payment-means-form>

    <div>
        <button class="btn btn-success" type="submit" [disabled]="!settingsForm.valid||!settingsForm.dirty||isSubmitting">
            <span>Save</span>
        </button>
		<div [hidden]="!isSubmitting" class="space-before">
			<img src="assets/form_loader.gif"/>
		</div>
    </div>

</form>

<ng-template #changeModal let-d="dismiss">
	<div class="modal-header">
		<h4 class="modal-title">Request Company Data Change</h4>
		<button type="button" class="close" aria-label="Close" (click)="d('')">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>
	<div class="modal-body">
		Any change to your company data has to be validated and processed by a platform administrator.<br/><br/>
		When you press "Open mail template" a partially prefilled mail template will open in the mail client of your choice.<br/><br/>
		We will process change requests within one business day.
	</div>
	<div class="modal-footer">
		<a [href]="mailto" type="button" class="btn btn-primary" (click)="d('')">Open mail template</a>
	</div>
</ng-template>

<ng-template #tooltip let-d="dismiss">
	<div class="modal-header">
		<h4 class="modal-title">Tooltip</h4>
		<button type="button" class="close" aria-label="Close" (click)="d('')">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>
	<div class="modal-body" [innerHTML]="tooltipHTML">
	</div>
</ng-template>
